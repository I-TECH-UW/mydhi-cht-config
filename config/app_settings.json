{
  "locales": [
    {
      "code": "en",
      "name": "English"
    },
    {
      "code": "es",
      "name": "Español (Spanish)"
    },
    {
      "code": "fr",
      "name": "Français (French)"
    },
    {
      "code": "ne",
      "name": "नेपाली (Nepali)"
    },
    {
      "code": "sw",
      "name": "Kiswahili (Swahili)"
    },
    {
      "code": "hi",
      "name": "हिन्दी (Hindi)"
    },
    {
      "code": "id",
      "name": "Bahasa Indonesia (Indonesian)"
    }
  ],
  "locale": "en",
  "locale_outgoing": "en",
  "muvuku_webapp_url": "/medic-reporter/_design/medic-reporter/_rewrite/?_embed_mode=2&_locale=en#/generic-anc.json",
  "date_format": "ddd, MMM Do, YYYY",
  "reported_date_format": "ddd, MMM Do, YYYY [at] h:mm A",
  "forms_only_mode": false,
  "default_responses": {
    "start_date": "1970-01-01"
  },
  "transitions": {
    "update_clinics": true,
    "registration": true,
    "accept_patient_reports": true,
    "generate_shortcode_on_contacts": true,
    "death_reporting": true
  },
  "district_admins_access_unallocated_messages": false,
  "public_access": false,
  "default_country_code": "256",
  "gateway_number": "+256780735585",
  "anc_forms": {
    "registration": "R",
    "registrationLmp": "P",
    "visit": "V",
    "delivery": "D",
    "flag": "F"
  },
  "schedule_morning_hours": 6,
  "schedule_morning_minutes": 0,
  "schedule_evening_hours": 20,
  "schedule_evening_minutes": 0,
  "synthetic_date": "",
  "contact_display_short": "clinic.name",
  "roles": {
    "national_admin": {
      "name": "usertype.national-manager"
    },
    "district_admin": {
      "name": "usertype.district-manager",
      "offline": true
    },
    "data_entry": {
      "name": "usertype.data-entry"
    },
    "analytics": {
      "name": "usertype.analytics"
    },
    "gateway": {
      "name": "usertype.gateway"
    }
  },
  "permissions": {
    "can_export_messages": [
      "national_admin",
      "district_admin",
      "analytics"
    ],
    "can_export_forms": [
      "national_admin",
      "district_admin",
      "analytics"
    ],
    "can_export_contacts": [
      "national_admin",
      "district_admin"
    ],
    "can_export_feedback": [
      "national_admin"
    ],
    "can_view_analytics": [
      "national_admin",
      "district_admin",
      "analytics"
    ],
    "can_view_data_records": [
      "national_admin",
      "district_admin",
      "analytics",
      "gateway"
    ],
    "can_view_unallocated_data_records": [
      "national_admin",
      "district_admin",
      "gateway"
    ],
    "can_view_users": [
      "national_admin"
    ],
    "can_edit": [
      "national_admin",
      "district_admin",
      "gateway"
    ],
    "can_log_out_on_android": [
      "district_admin",
      "national_admin"
    ],
    "can_update_messages": [
      "national_admin",
      "district_admin",
      "gateway"
    ],
    "can_update_users": [
      "national_admin"
    ],
    "can_export_dhis": [
      "national_admin"
    ],
    "can_update_people": [
      "national_admin",
      "district_admin"
    ],
    "can_update_places": [
      "national_admin",
      "district_admin"
    ],
    "can_create_records": [
      "national_admin",
      "district_admin",
      "data_entry",
      "gateway"
    ],
    "can_access_gateway_api": [
      "gateway"
    ],
    "can_create_users": [
      "national_admin"
    ],
    "can_create_people": [
      "national_admin",
      "district_admin"
    ],
    "can_create_places": [
      "national_admin",
      "district_admin"
    ],
    "can_view_tasks": [
      "district_admin"
    ],
    "can_view_tasks_tab": [
      "district_admin"
    ],
    "can_configure": [
      "national_admin"
    ],
    "can_view_messages": [
      "national_admin",
      "district_admin"
    ],
    "can_view_messages_tab": [
      "national_admin",
      "district_admin"
    ],
    "can_view_reports": [
      "national_admin",
      "district_admin"
    ],
    "can_view_reports_tab": [
      "national_admin",
      "district_admin"
    ],
    "can_view_analytics_tab": [
      "national_admin",
      "district_admin"
    ],
    "can_view_contacts": [
      "national_admin",
      "district_admin"
    ],
    "can_view_contacts_tab": [
      "national_admin",
      "district_admin"
    ],
    "can_edit_profile": [
      "national_admin",
      "district_admin"
    ],
    "can_delete_reports": [
      "national_admin",
      "district_admin"
    ],
    "can_bulk_delete_reports": [
      "national_admin",
      "district_admin"
    ],
    "can_update_reports": [
      "national_admin",
      "district_admin"
    ],
    "can_delete_contacts": [
      "national_admin",
      "district_admin"
    ],
    "can_delete_messages": [
      "national_admin",
      "district_admin"
    ],
    "can_delete_users": [
      "national_admin"
    ],
    "can_view_outgoing_messages": [
      "national_admin"
    ],
    "can_export_all": [
      "national_admin"
    ],
    "can_view_uhc_stats": []
  },
  "setup_complete": true,
  "outgoing_phone_replace": {
    "match": "",
    "replace": ""
  },
  "outgoing_phone_filters": [
    {
      "match": "",
      "replace": ""
    }
  ],
  "id_format": "1111",
  "alerts": [
    {
      "form": "",
      "condition": "",
      "message": "",
      "recipient": ""
    }
  ],
  "reminders": [
    {
      "form": "",
      "text_expression": "",
      "cron": "",
      "mute_after_form_for": "",
      "message": ""
    }
  ],
  "replications": [
    {
      "fromSuffix": "user-[^\\-]+-meta",
      "toSuffix": "users-meta",
      "text_expression": "",
      "cron": "0 2 * * *"
    }
  ],

  "registrations": [
    {
      "form": "N",
      "events": [
        {
          "name": "on_create",
          "trigger": "add_patient",
          "params": "{ \"parent_id\": \"place_id\" }",
          "bool_expr": ""
        }
      ],
      "validations": {
        "join_responses": true,
        "list": [
          {
            "property": "place_id",
            "rule": "regex('^[0-9]{5,13}$')",
            "translation_key": "messages.n.validation.place_id"
          },
          {
            "property": "gender",
            "rule": "iEquals('m') || iEquals('f')",
            "translation_key": "messages.n.validation.gender"
          },
          {
            "property": "age",
            "rule": "between(5,130)",
            "translation_key": "messages.n.validation.age"
          }
        ]
      },
      "messages": [
        {
          "event": "report_accepted",
          "translation_key": "messages.n.report_accepted",
          "recipient": "reporting_unit"
        }
      ]
    }
  ],

  "forms": {
    "N": {
    "meta": {
      "code": "N",
      "label": {
        "en": "New Person Registration"
      }
    },
    "fields": {
      "place_id": {
        "labels": {
          "tiny": {
            "en": "place_id"
          },
          "description": {
            "en": "Household ID"
          },
          "short": {
            "en": "HH ID"
          }
        },
        "position": 0,
        "type": "string",
        "length": [
          1,
          13
        ],
        "required": true
      },
      "gender": {
        "labels": {
          "tiny": {
            "en": "gender"
          },
          "description": {
            "en": "Gender"
          },
          "short": {
            "en": "Gender"
          }
        },
        "position": 1,
        "type": "string",
        "length": [
          1,
          6
        ],
        "required": true
      },
      "age": {
        "labels": {
          "tiny": {
            "en": "age"
          },
          "description": {
            "en": "Age"
          },
          "short": {
            "en": "Age"
          }
        },
        "position": 2,
        "type": "integer",
        "length": [
          1,
          2
        ],
        "required": true
      },
      "patient_name": {
        "labels": {
          "tiny": {
            "en": "patient_name"
          },
          "description": {
            "en": "Patient name"
          },
          "short": {
            "en": "Patient name"
          }
        },
        "position": 3,
        "type": "string",
        "length": [
          3,
          30
        ],
        "required": true
      }
    }
  }
  },

  "schedules": [],
  "contact_summary": "var ContactSummary = {}; !function(e,t){if('object'==typeof exports&&'object'==typeof module)module.exports=t();else if('function'==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)('object'==typeof exports?exports:e)[r]=n[r]}}(ContactSummary,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&'object'==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,'default',{enumerable:!0,value:e}),2&t&&'string'!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,'a',t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p='',n(n.s=0)}([function(e,t,n){var r=n(1),i=n(3);e.exports=i(r,contact,reports)},function(e,t,n){const{now:r,MS_IN_DAY:i,DAYS_IN_PNC:o,IMMUNIZATION_LIST:a,isCoveredByUseCaseInLineage:l,getTreatmentProgram:s,getNewestDelivery:c,getNewestPncPeriod:f,getDeliveryCode:u,isFacilityDelivery:p,getBirthDate:d,isHighRiskPostnatal:m,addImmunizations:_,getMostRecentNutritionEnrollment:h,isReportValid:g,countNutritionFollowups:v,isActivePregnancy:y,getSubsequentVisits:w,isHighRiskPregnancy:b,getSubsequentDeliveries:T,getOldestReport:P,getSubsequentPregnancies:I,getAgeInMonths:M,initImmunizations:x,isVaccineInLineage:C,isSingleDose:D,countDosesReceived:V,countDosesPossible:O,countReportsSubmittedInWindow:N,getMostRecentReport:A,getTreatmentEnrollmentDate:R,pregnancyForms:S,antenatalForms:F,postnatalForms:E,immunizationForms:H}=n(2);var k={use_cases:{anc:l(lineage,'anc'),pnc:l(lineage,'pnc'),imm:l(lineage,'imm'),gmp:l(lineage,'gmp')},treatment_program:s(),enrollment_date:R()},U=[{appliesToType:'person',label:'patient_id',value:contact.patient_id,width:4},{appliesToType:'person',label:'contact.age',value:contact.date_of_birth,width:4,filter:'age'},{appliesToType:'person',label:'Phone Number',value:contact.phone,width:4,filter:'phone'},{appliesToType:'person',label:'Notes',value:contact.notes,width:12},{appliesToType:'person',label:'contact.parent',value:lineage,filter:'lineage'},{appliesToType:'!person',label:'Notes',value:contact.notes,width:12},{appliesToType:'!person',appliesIf:function(){return contact.parent&&lineage[0]},label:'contact.parent',value:lineage,filter:'lineage'}],j=[{label:'contact.profile.pregnancy',appliesToType:'report',appliesIf:y,fields:[{label:'contact.profile.edd',value:function(e){return e.expected_date||e.fields.edd_8601},filter:'relativeDay',width:12},{label:'contact.profile.visit',value:'contact.profile.visits.of',translate:!0,context:{count:function(e){return w(e).length},total:4},width:6},{label:'contact.profile.risk.title',value:function(e){return b(e)?'contact.profile.risk.high':'contact.profile.risk.normal'},translate:!0,width:5,icon:function(e){return b(e)?'risk':''}}],modifyContext:function(e){e.pregnant=!0}},{label:'contact.profile.postnatal',appliesToType:'person',appliesIf:function(){if(k.use_cases.pnc){var e=f();return r>=e.start&&r<=e.end}},fields:[{label:function(){return'contact.profile.delivery_code.'+u(c())},value:function(){var e=c();return d(e).getTime()},filter:'relativeDay',width:12},{label:'contact.profile.pnc_visit',value:'contact.profile.visits.of',translate:!0,context:{count:function(){var e=c(),t=d(e),n=reports.filter((function(e){return('M'===e.form||'postnatal_visit'===e.form)&&e.reported_date>t.getTime()&&e.reported_date<t.getTime()+(o+1)*i})).length;return p(e)&&n++,n},total:4},width:6},{label:'contact.profile.risk.title',value:function(){var e=f();return m(e)?'contact.profile.risk.high':'contact.profile.risk.normal'},translate:!0,width:5,icon:function(){var e=f();return m(e)?'risk':''}}],modifyContext:function(e){e.in_pnc_period=!0}},{label:'contact.profile.past_pregnancies',appliesToType:'person',appliesIf:c,fields:function(){var e,t,n,r,a,s,c,f,m,_=[];return reports.forEach((function(h){if(g(h)&&S.indexOf(h.form)>=0){if(0===(c=T(h)).length)return;if(e=P(c),t=d(e),f=I(h),(m=P(f))&&m.reported_date<e.reported_date)return;n=reports.filter((function(e){return F.indexOf(e.form)>=0&&e.reported_date>h.reported_date&&e.reported_date<t.getTime()+i})),r=reports.filter((function(e){return E.indexOf(e.form)>=0&&e.reported_date>t.getTime()&&e.reported_date<t.getTime()+(o+1)*i})),a=n.length,s=r.length,p(e)&&s++,_.push({label:'contact.profile.delivery_code.'+u(e),value:t,filter:'relativeDay',width:6},{label:'contact.profile.anc_visit',value:'contact.profile.visits.of',translate:!0,context:{count:a,total:4},width:3}),l(lineage,'pnc')&&_.push({label:'contact.profile.pnc_visit',value:'contact.profile.visits.of',translate:!0,context:{count:s,total:4},width:3})}})),_}},{label:'contact.profile.immunizations',appliesToType:'person',appliesIf:function(){return k.use_cases.imm&&M()<144},fields:function(){var e,t,n=x();for(e=0;e<reports.length;++e)'immunization_visit'===(t=reports[e]).form?t&&t.fields&&t.fields.vaccines_received&&_(n,t.fields.vaccines_received):'C_IMM'===t.form?_(n,t.fields):_(n,t.form);var i=[];return a.forEach((function(e){if(C(lineage,e)){var t={label:'contact.profile.imm.'+e,translate:!0,width:6};D(e)?t.value=n[e]?'yes':'no':(t.value='contact.profile.imm.doses',t.context={count:V(n,e),total:O(e)}),i.push(t)}})),i.length||i.push({label:'contact.profile.imm.generic',translate:!0,value:N(H,r),width:12}),i}},{label:'contact.profile.growth_monitoring',appliesToType:'person',appliesIf:function(){return k.use_cases.gmp&&M()<60&&!!A(reports,['nutrition_screening'])},fields:function(){var e=[],t=A(reports,['nutrition_screening']);return e.push({label:'contact.profile.weight',translate:!0,width:3,value:t.fields.measurements.weight}),e.push({label:'contact.profile.height',translate:!0,width:3,value:t.fields.measurements.height}),e.push({label:'contact.profile.gender',translate:!0,width:3,value:t.fields.measurements.gender}),Object.hasOwnProperty.call(t.fields.measurements,'muac')&&e.push({label:'contact.profile.muac',translate:!0,width:3,value:t.fields.measurements.muac}),e.push({label:'contact.profile.wfa',translate:!0,width:4,value:t.fields.wfa,icon:t.fields.wfa<-3?'warning':''}),e.push({label:'contact.profile.hfa',translate:!0,width:4,value:t.fields.hfa,icon:t.fields.hfa<-3?'warning':''}),e.push({label:'contact.profile.wfh',translate:!0,width:4,value:t.fields.wfh,icon:t.fields.wfh<-3?'warning':''}),e}},{label:'contact.profile.imam',appliesToType:'person',appliesIf:function(){return!!s()},fields:function(){var e=[],t=h().enrollment;return t&&(e.push({label:'contact.profile.weight',translate:!0,width:3,value:t.fields.measurements.weight}),e.push({label:'contact.profile.height',translate:!0,width:3,value:t.fields.measurements.height}),Object.hasOwnProperty.call(t.fields.measurements,'muac')&&e.push({label:'contact.profile.muac',translate:!0,width:3,value:t.fields.measurements.muac}),e.push({label:'contact.profile.wfh',translate:!0,width:3,value:t.fields.wfh,icon:t.fields.wfh<-3?'risk':''}),e.push({label:'contact.profile.nutrition_program',translate:!0,width:6,value:'OTP'===t.fields.treatment.program?'contact.profile.nutrition_program.otp':'SFP'===t.fields.treatment.program?'contact.profile.nutrition_program.sfp':'SC'===t.fields.treatment.program?'contact.profile.nutrition_program.sc':void 0}),e.push({label:'contact.profile.sessions',value:'contact.profile.visits.of',translate:!0,width:6,context:{count:v(),total:8}})),e}},{label:'contact.profile.imam_history',appliesToType:'person',appliesIf:function(){return!!h().exit},fields:function(){var e=[],t=h().enrollment,n=h().exit,r=new Date(0);return r.setUTCSeconds(n.reported_date/1e3),t&&(e.push({label:'contact.profile.last_treatment',translate:!0,width:6,value:t.fields.treatment.program}),e.push({label:'contact.profile.exit_date',translate:!0,width:6,value:r.toISOString().slice(0,10)}),e.push({label:'contact.profile.weight_at_exit',translate:!0,width:6,value:n.fields.measurements.weight}),e.push({label:'contact.profile.height_at_exit',translate:!0,width:6,value:n.fields.measurements.height}),e.push({label:'contact.profile.wfh',translate:!0,width:12,value:n.fields.measurements.wfh})),e}}];lineage[0]&&lineage[0].contact&&(k.chw_name=lineage[0].contact.name,k.chw_phone=lineage[0].contact.phone),e.exports={context:k,cards:j,fields:U}},function(e,t){var n=Date.now(),r=['P','pregnancy'],i=['D','delivery'],o=[['bcg','BCG'],['cholera_1','CH1'],['cholera_2','CH2'],['cholera_3','CH3'],['hep_a_1','HA1'],['hep_a_2','HA2'],['hep_b','HB'],['hpv_1','HPV1'],['hpv_2','HPV2'],['hpv_3','HPV3'],['ipv_1','IPV1'],['ipv_2','IPV2'],['ipv_3','IPV3'],['fipv_1','FIPV1'],['fipv_2','FIPV2'],['flu','FLU'],['jap_enc','JE'],['meningococcal_1','MN1'],['meningococcal_2','MN2'],['meningococcal_3','MN3'],['meningococcal_4','MN4'],['mmr_1','MMR1'],['mmr_2','MMR2'],['mmrv_1','MMRV1'],['mmrv_2','MMRV2'],['polio_0','OPV0'],['polio_1','OPV1'],['polio_2','OPV2'],['polio_3','OPV3'],['penta_1','PENTA1'],['penta_2','PENTA2'],['penta_3','PENTA3'],['pneumococcal_1','PCV1'],['pneumococcal_2','PCV2'],['pneumococcal_3','PCV3'],['pneumococcal_4','PCV4'],['rotavirus_1','ROTA1'],['rotavirus_2','ROTA2'],['rotavirus_3','ROTA3'],['typhoid_1','TY1'],['typhoid_2','TY2'],['vitamin_a','VITA'],['yellow_fever','YF'],['dpt_4','DPT4'],['dpt_5','DPT5']];function a(e){return e&&!(e.errors&&e.errors.length)}function l(e,t){for(var n=0,r=0;r<e.length;++r)t(e[r])&&++n;return n}function s(e,t){return e&&-1!==e.split(' ').indexOf(t)}var c=function(e,t){return e&&(s(e.use_cases,t)||c(e.parent,t))};function f(e){return e&&i.indexOf(e.form)&&e.fields&&e.fields.delivery_code&&'f'!==e.fields.delivery_code.toLowerCase()}function u(e){var t=e&&(e.birth_date||e.fields.birth_date||e.reported_date);return new Date(t)}function p(e){var t=u(e);return{start:t,end:d(t,45)}}function d(e,t){var n=new Date(e);return n.setUTCDate(n.getUTCDate()+t),n.setUTCHours(0,0,0,0),n}function m(e){return reports.filter((function(t){return('delivery'===t.form||'D'===t.form)&&t.reported_date>e.reported_date}))}function _(e){return reports.filter((function(t){return r.indexOf(t.form)>=0&&t.reported_date>e.reported_date}))}function h(){var e;if('person'===contact.type)return reports.forEach((function(t){a(t)&&('D'!==t.form&&'delivery'!==t.form||(!e||t.fields&&e.fields&&t.fields.date_of_birth>e.fields.date_of_birth)&&(e=t))})),e}function g(){var e={enrollment:null,exit:null},t=[];return reports.forEach((function(n){'nutrition_screening'!==n.form||n.deleted||e.enrollment&&!(n.reported_date>e.enrollment.reported_date&&'yes'===n.fields.treatment.enroll)||(e.enrollment=n),'nutrition_exit'===n.form&&t.push(n)})),e.enrollment&&(e.exit=t.find((function(t){return t.reported_date>e.enrollment.reported_date}))),e}e.exports={now:n,pregnancyForms:r,antenatalForms:['V','pregnancy_visit'],deliveryForms:i,postnatalForms:['M','postnatal_visit'],immunizationForms:['IMM','C_IMM','immunization_visit','PENTA1','PENTA2','PENTA3','BCG','OPV0','OPV1','OPV2','OPV3','IPV1','IPV2','IPV3','FIPV1','FIPV2','PCV1','PCV2','PCV3','PCV4','ROTA1','ROTA2','ROTA3','VITA','MMR1','MMR2','MMRV1','MMRV2','MN1','MN2','MN3','MN4','FLU','HA1','HA2','HB','JE','YF','TY1','TY2','HPV1','HPV2','HPV3','CH1','CH2','CH3','DPT4','DPT5'],MS_IN_DAY:864e5,MAX_DAYS_IN_PREGNANCY:308,DAYS_IN_PNC:45,IMMUNIZATION_DOSES:o,IMMUNIZATION_LIST:['bcg','cholera','hep_a','hep_b','hpv','ipv','fipv','flu','jap_enc','meningococcal','mmr','mmrv','polio','penta','pneumococcal','rotavirus','typhoid','vitamin_a','yellow_fever','dpt'],count:l,isVaccineInLineage:function(e,t){return e&&e.some((function(e){return e&&s(e.vaccines,t)}))},isCoveredByUseCaseInLineage:function(e,t){return e&&e.some((function(e){return e&&s(e.use_cases,t)}))},contains:s,isCoveredByUseCase:c,isFacilityDelivery:function(e){return e&&e.fields&&e.fields.delivery_code&&'f'===e.fields.delivery_code.toLowerCase()},isNonFacilityDelivery:f,getBirthDate:u,isReportValid:a,getPNCperiod:p,isHighRiskPregnancy:function(e){return'pregnancy'===e.form&&e.fields&&(e.fields.risk_factors||e.fields.danger_signs)||reports.some((function(t){return a(t)&&t.reported_date>e.reported_date&&t.reported_date<=d(e.reported_date,308).getTime()&&('F'===t.form.toUpperCase()||'pregnancy_visit'===t.form&&t.fields&&t.fields.danger_signs)}))},isHighRiskPostnatal:function(e){return e&&e.start&&e.end&&reports.some((function(t){return a(t)&&(f(t)||'F'===t.form.toUpperCase()&&t.reported_date>=e.end.getTime()&&t.reported_date<=e.end.getTime()||'postnatal_visit'===t.form&&t.fields&&(t.fields.danger_signs_mom||t.fields.danger_signs_baby))}))},getDeliveryCode:function(e){return(e&&e.fields&&(e.fields.group_note&&e.fields.group_note.default_chw_sms||e.fields.delivery_code)||'unknown').toLowerCase().replace('anc_only_','')},initImmunizations:function(){var e={};return o.forEach((function(t){e[t[0]]=!1})),e},addImmunizations:function(e,t){o.forEach((function(n){e[n[0]]||(e[n[0]]='string'==typeof t?t.toUpperCase()===n[1]:'yes'===t['received_'+n[0]])}))},countDosesReceived:function(e,t){return l(o,(function(n){return e[n[0]]&&0===n[0].indexOf(t+'_')}))},countDosesPossible:function(e){return l(o,(function(t){return 0===t[0].indexOf(e+'_')}))},isSingleDose:function(e){return o.some((function(t){return t[0]===e}))},countReportsSubmittedInWindow:function(e,t){return l(reports,(function(n){return n.reported_date<=t&&-1!==e.indexOf(n.form)}))},addDate:d,getOldestReport:function(e){var t;return e.forEach((function(e){a(e)&&(!t||e.reported_date<t.reported_date)&&(t=e)})),t},isActivePregnancy:function(e){return!('person'!==contact.type||'P'!==e.form&&'pregnancy'!==e.form||m(e).length||_(e).length)},getSubsequentDeliveries:m,getSubsequentPregnancies:_,getAgeInMonths:function(){var e,t;if(contact.date_of_birth&&''!==contact.date_of_birth)return e=new Date(contact.date_of_birth),t=new Date(Date.now()-e.getTime()),12*Math.abs(t.getFullYear()-1970)+t.getMonth()},getNewestDelivery:h,getNewestPncPeriod:function(){return p(h())},getSubsequentVisits:function(e){return reports.filter((function(t){return('pregnancy_visit'===t.form&&t.fields.visit_confirmed&&'yes'===t.fields.visit_confirmed||'V'===t.form)&&t.reported_date>e.reported_date}))},getTreatmentEnrollmentDate:function(){var e='',t=g().enrollment;if(t){var n=new Date(0);n.setUTCSeconds(t.reported_date/1e3),e=n.toISOString().slice(0,10)}return e},getTreatmentProgram:function(){var e='',t=g().enrollment,n=g().exit;return t&&!n&&(e=t.fields.treatment.program),e},countNutritionFollowups:function(){var e=0,t=g().enrollment;return reports.forEach((function(n){'nutrition_followup'===n.form&&n.reported_date>t.reported_date&&(e+=1)})),e},getMostRecentReport:function(e,t){var n=null;return e.forEach((function(e){t.indexOf(e.form)>=0&&!e.deleted&&(!n||e.reported_date>n.reported_date)&&(n=e)})),n},getMostRecentNutritionEnrollment:g}},function(e,t){function n(e){return e?Array.isArray(e)?e:[e]:[]}function r(e,t){switch(typeof e){case'undefined':return!0;case'function':return e(t);default:return e}}function i(e,t,n){if(r(e.appliesIf,n)){var i='function'==typeof e.fields?e.fields(n):e.fields.filter((function(e){return r(e.appliesIf,n)})).map((function(e){var t={};return o(e,t,'label'),o(e,t,'value'),o(e,t,'translate'),o(e,t,'filter'),o(e,t,'width'),o(e,t,'icon'),e.context&&(t.context={},o(e.context,t.context,'count'),o(e.context,t.context,'total')),t}));return e.modifyContext&&e.modifyContext(t,n),{label:e.label,fields:i}}function o(e,t,r){switch(typeof e[r]){case'undefined':return;case'function':t[r]=e[r](n);break;default:t[r]=e[r]}}}e.exports=function(e,t,r){var o=e.fields||[],a=e.context||{},l=e.cards||[],s=t&&('contact'===t.type?t.contact_type:t.type),c={cards:[],fields:o.filter((function(e){var t=n(e.appliesToType),r=t.filter((function(e){return e&&'!'===e.charAt(0)}));if((0===t.length||t.includes(s)||r.length>0&&!r.includes('!'+s))&&(!e.appliesIf||e.appliesIf()))return delete e.appliesToType,delete e.appliesIf,!0}))};return l.forEach((function(e){var t,o,l,f,u=n(e.appliesToType);if(u.includes('report')&&u.length>1)throw new Error('You cannot set appliesToType to an array which includes the type \\'report\\' and another type.');if(u.includes('report'))for(t=0;t<r.length;++t)o=r[t],!(f=o)||f.errors&&f.errors.length||(l=i(e,a,o))&&c.cards.push(l);else{if(!u.includes(s)&&u.length>0)return;(l=i(e,a))&&c.cards.push(l)}})),c.context=a,c}}])})); return ContactSummary;",
  "tasks": {
    "rules": "define Target { _id: null, contact: null, deleted: null, type: null, pass: null, date: null, groupBy: null }\ndefine Contact { contact: null, reports: null, tasks: null }\ndefine Task { _id: null, deleted: null, doc: null, contact: null, icon: null, date: null, readyStart: null, readyEnd: null, title: null, fields: null, resolved: null, priority: null, priorityLabel: null, reports: null, actions: null }\nrule GenerateEvents {\n  when { c: Contact } then { !function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&'object'==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,'default',{enumerable:!0,value:e}),2&t&&'string'!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,'a',t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p='',n(n.s=1)}([function(e,t){e.exports=function(e){var t={};!function e(t,n){var r=Object.keys(t);for(var o in r){var a=r[o];switch(typeof t[a]){case'object':e(t[a],n);break;case'function':t[a]=t[a].bind(n)}}}(e,t),t.definition=function e(t){var n=Object.assign({},t),r=Object.keys(n);for(var o in r){var a=r[o];if(Array.isArray(n[a])){n[a]=n[a].slice(0);for(var i=0;i<n[a].length;++i)'object'==typeof n[a][i]&&(n[a][i]=e(n[a][i]))}else'object'==typeof n[a]&&(n[a]=e(n[a]))}return n}(e)}},function(e,t,n){var r=n(2),o=n(3),a=n(4);n(6)(o,c,Utils,Target,emit),a(r,c,Utils,Task,emit),emit('_complete',{_id:!0})},function(e,t){e.exports=[]},function(e,t){e.exports=[]},function(e,t,n){var r=n(0),o=n(5);function a(e,t,n,r,o,a){var i;if(e.appliesToType){var c;if('contacts'===e.appliesTo){if(!o.contact)return;c='contact'===o.contact.type?o.contact.contact_type:o.contact.type}else{if(!a)return;c=a.form}if(-1===e.appliesToType.indexOf(c))return}if('scheduled_tasks'===e.appliesTo||!e.appliesIf||e.appliesIf(o,a))if('scheduled_tasks'===e.appliesTo){if(a&&e.appliesIf){if(!a.scheduled_tasks)return;for(i=0;i<a.scheduled_tasks.length;i++)e.appliesIf(o,a,i)&&d(i)}}else d();function s(e,t,n){var r;return(r='function'==typeof e.contactLabel?e.contactLabel(t,n):e.contactLabel)?{name:r}:t.contact}function d(i){var c,d,p,u,l=null;for(c=0;c<e.events.length;c++){if((d=e.events[c]).dueDate)l=d.dueDate(d,o,a,i);else if(a)l=void 0!==i?new Date(t.addDate(new Date(a.scheduled_tasks[i].due),d.days)):new Date(t.addDate(new Date(a.reported_date),d.days));else if(d.dueDate)l=d.dueDate(d,o);else{var y=o.contact&&o.contact.reported_date?new Date(o.contact.reported_date):new Date;l=new Date(t.addDate(y,d.days))}t.isTimely(l,d)&&(u={_id:(a?a._id:o.contact&&o.contact._id)+'~'+(d.id||c)+'~'+e.name,deleted:!(!(o.contact&&o.contact.deleted||a)||!a.deleted),doc:o,contact:s(e,o,a),icon:e.icon,date:l,readyStart:d.start||0,readyEnd:d.end||0,title:e.title,resolved:e.resolvedIf(o,a,d,l,i),actions:f(e.actions,d)},void 0!==i&&(u._id+='-'+i),'function'==typeof(p=e.priority)&&(p=p(o,a)),p&&(u.priority=p.level,u.priorityLabel=p.label),r('task',new n(u)))}}function f(t,n){return e.actions.map((function(e){return function(e,t){var n={source:'task',source_id:a?a._id:o.contact&&o.contact._id,contact:o.contact};e.modifyContent&&e.modifyContent(n,o,a,t);return{type:e.type||'report',form:e.form,label:e.label||'Follow up',content:n}}(e,n)}))}}e.exports=function(e,t,n,i,c){if(e)for(var s,d,f=0;f<e.length;++f)switch('function'!=typeof(s=Object.assign({},e[f],o)).resolvedIf&&(s.resolvedIf=function(e,t,r,o){return s.defaultResolvedIf(e,t,r,o,n)}),r(s),s.appliesTo){case'reports':case'scheduled_tasks':for(var p=0;p<t.reports.length;++p)d=t.reports[p],a(s,n,i,c,t,d);break;case'contacts':t.contact&&a(s,n,i,c,t);break;default:throw new Error('Unrecognised task.appliesTo: '+s.appliesTo)}}},function(e,t){e.exports={defaultResolvedIf:function(e,t,n,r,o){var a,i;o||(o=Utils);var c=function(e){var t;if(!e||!e.actions)return;return(t=e.actions.find((function(e){return!e.type||'report'===e.type})))&&t.form}(this.definition);if(!c)throw new Error('Could not find the default resolving form!');return a=0,a=t?Math.max(o.addDate(r,-n.start).getTime(),t.reported_date+1):o.addDate(r,-n.start).getTime(),i=o.addDate(r,n.end+1).getTime(),o.isFormSubmittedInWindow(e.reports,c,a,i)}}},function(e,t,n){var r=n(0);function o(e,t,n,r,o,a){var i=!!a;if(o.contact){var c='contact'===o.contact.type?o.contact.contact_type:o.contact.type,s=i?a.form:c;if(!(e.appliesToType&&e.appliesToType.indexOf(s)<0)&&(!e.appliesIf||e.appliesIf(o,a)))for(var d=i?a:o.contact,f=function(e,t,n){var r;return r='function'==typeof e.idType?e.idType(t,n):'report'===e.idType?n&&n._id:t.contact&&t.contact._id,Array.isArray(r)||(r=[r]),r}(e,o,a),p=!e.passesIf||!!e.passesIf(o,a),u=function(e,t,n,r){if('function'==typeof e.date)return e.date(n,r);if(void 0===e.date||'now'===e.date)return t.now().getTime();if('reported'===e.date)return r?r.reported_date:n.contact.reported_date;throw new Error('Unrecognised value for target.date: '+e.date)}(e,n,o,a),l=e.groupBy&&e.groupBy(o,a),y=0;y<f.length;++y){var v=new t({_id:f[y]+'~'+e.id,contact:o.contact,deleted:!!d.deleted,type:e.id,pass:p,groupBy:l,date:u});e.emitCustom?e.emitCustom(b,v,o,a):b(v)}}function b(e){r('target',e)}}e.exports=function(e,t,n,a,i){for(var c=0;c<e.length;++c){var s=e[c];switch(r(s),s.appliesTo){case'contacts':o(s,a,n,i,t);break;case'reports':for(var d=0;d<t.reports.length;++d){o(s,a,n,i,t,t.reports[d])}break;default:throw new Error('Unrecognised target.appliesTo: '+s.appliesTo)}}}}]); }\n}",
    "targets": {
      "enabled": true,
      "items": []
    }
  }
}

